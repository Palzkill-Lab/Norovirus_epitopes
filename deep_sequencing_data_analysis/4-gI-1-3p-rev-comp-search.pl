#!/usr/bin/perl
#use lib '/Users/timothypalzkill/perl5/lib/perl5';
#use Excel::Writer::XLSX; # use module to write output to an Excel spreadsheet

%{hits} = ();
my $count1 = 0;

open (MATCHEDCOORDSEQFILE, "<", $ARGV[0]);

# open COUNTSUM, ">>search-files/search-summary";
open (COUNTSUM, ">", $ARGV[1]);
# open OUTFILE, ">search-files/GI-1-$pos-3p-end-results";
# open (OUTFILE, ">", $ARGV[2]);
#open (WAO, ">", $ARGV[2]);


while ($line = <MATCHEDCOORDSEQFILE>) {# reads line by line from the input file, which is the paired end reads obtained from coord-find and strip-coords programs ##
	chomp $line;
#	print "$line\n";	
	if ($line =~ /0 seqs/) {
		print "0 seqs\n";
#		print OUTFILE "0 seqs";
#		print COUNTSUM "0";
		goto ENDPOSLOOP;
	}
	(my $fivepjunc, my $coordread) = split (/\t/, $line);
	(my$dummybitch, my $coord, my $dummy, my $read) = split (/ /, $coordread);
################!!!!!!!!THERE IS A SPACE AFTER TAB - ADJUST AFTER R1R2R3-257 FILES!!!	
	
	push(@reads, $read); # This puts the reads from the input file into an array to be used below. ###
	push(@fivepjuncs, $fivepjunc);
ENDPOSLOOP:
}  # end of while loop


print ("done reading in seqfile\n");
$str = "ATCACCACTTTGTACAAGAAAGCTGGGTCCTTTCGGGCTTTGTTAGCAGCCGGATCCCCGCCCTCCCTTAGCCATCCGAGTGGACGTGCGTCCTCCTTCGGATGCCCAGGTCGGACCGCGAGGAGGTGGAGATGCCATGCCGACCCAACATCAAATTAAACCTAATTAAACCTAATTAAATGAATATGATGCCCACATTTCATATTACAACATCATCGCCTATTATTTGCGAATAATGGCAACCTGTCTGTATTGAAATAACCACGTGGCACAGAAGACAGTGTAGAAGAGGCTGTTGAACCGGGTGGAGTCAACCACACTGTATTGAGAGCCTCCGCGTGGTATGGAGAAAGATTTCCAAATCTCGATGAGTTTTGTGACTCGACCCAACTAGTGGTTCGAGAAATGGATGAAGGGGAATAATTTGGATTACTAATACCAGATGATTGAACCTGTTTTTGCTTAGAGGCAAATGGTATGGGAACTGACATGAAGCCACCGGATCTCAATGTGGTAGCAGAGGACTCGGGAGCAGACACTCTCACGCCATTCCAATCTACAATGCGGGTGACTGGAGCTCCTGCCACAGATCTTGCTGCATCAGCACTGGTCAAACCCCCAGCACGGAGGAGTGAATATCTAGTTGCCAAATTTTTAGCCAATAATTGATTTGAAGCTTCAACCTGATACCCAATCATTTCCCTGTCATGTTTAAAAGAATTTTCTTGCAGTTGCAAATTTTGTTGATACCTTTGGCTTTGGAGGGCCGCTTCGCCACCAACCTGTATGCCCGCTCCCAGAGCACTACCTGCTGTGGAAGCAGCAATTGCACCAATTATGGCTTGGGCCATTATCGGCGCAGACCAAGCCTACCTCTTGCCGAGCTGGCAGTTCCCACAGGCTTTAATTGATAAAATCTGGACACCCATGAAACAAAGACAAAGACCCCATTGATCGGCAGCTGTTGTGGACCCGAGCTAGCCCCATTGGGGACACAAGTGAGGAAACCATCAGGGTATGCTTTGAATTCCCCAAGATTCCGACCGGTATCAGGGTCAACATAGTGGAGCAGGGCAGCCTCACCTACAGTAGGGGCTTGTTCACTAGCAAGATGTGAAATGTACTCTTGTGGTAATAGACAGGGCAAATTATAAGCACCAGGACCTGGCATTTTTGACATGAAAAAGACCAATACCTCTCCGAAACCAGGGGGGTATACAGAAGGGGCTAGATGTGTTGCCTCCGTAATACTTGACCCATAATTGGGGATCTTCCAAAGGTCAACTTGGGAGCCAGACGGGTGTGATGGGGGGGAAATCCAGCTAAGAACACCAACATAATTACCACTGCCAATGCCATTTGCCTGAATTGAACCAAGATGGGGGACAAAAGTGTCAGGGGTGGTGTCTACATCATACTGGGTCTGGCTAGAATGGCCAAACTGTGTCATATTGATATGCCAATCACAACCACCGAGGTCTGGAAACCCAATGGGGGCAGGGCCCTCAAAAGGGTGAAAGGGTGTGCCATCCAATTCAGTAAGGTTGATTACAGTGCCATTGGAGGTCCCTCTTATCTTGGCAACATGTGACAATGAAACTGGGGTGGTGCCAACCAGGCGGCCATCCAGAGTACACCGACCATTTTGGAACTGCACACTCTGGACATTGTCTGGGGAAATGCCCATACTACTGATTGGGAGAGGGGCACGTGAGTTAGACAGAGAACTCAATGGCAGATTTGGGAGTGTGAAGGGCCTGGTTTTCTGCTCCACCGTAGGAGGGACTAAAAACAAGAAATTAAAATCAGGACTGGGGCAAGTCATAACTCGCCCTGCAACTACAAAAGAATCACCAGTACCACCACCAGTGCGGAGGGGGGTGTACAGCATGCACACAAGGCGCATGGTTTGTTGATTTCTATCATTATTATGAAAGAGAACATTCCTAACATCTTCCAAAGGCACCTCAATGGGGTCTAGAGTCCTAACATCAGCAATCACATGTGGAAAGAGAGTTGCTTGTGCTATAGTAAGATTATGTGAACCAAAACCAGGGGGTATGCAGGAAACTATTATCTTCCCCGCAGTAAAGGCATTACCAGCTAGCATAATCCTGACTCTCATGTTACCAACCCAACCATTATACATTTGTGATAGATGGAGCAAGAAAGGATTAAGATGGGGACCCAAACTCAAATCAAACAAAACATCACCGGGGGTATTATTTGGGGAAATAGTAAATTCACCTTGGGGGGCTTGCACAAAATTATTAATTATCCAGGGATCAATAGGATTAACTTGTCCAGCAGTCGCGACTGCTGTCGAAGAACCTGCTACAGGATCCATTGCAAGAGGGTCAGAAGCATTAACCTCCGGTACCAACTGACCAGCGCCACTAGCGCCATCCACGCTTGATGTAGCGTCCTTAGACGCCATCATCATTTACGAATTCGGGCAGAAGATCGCGATCTCCTGTCCACAATCCGAGGTCATGGAAGCGCATCCAGCGGAACATGGCCTGCCATCCTGGGACATACATTTCCAATCCACCAGTCTTGATTTCATGTATGACCTTGCTGGAAATCTTTCTGTAAAATTTCTCACCATGGAGTGAAGCTTCCCCTAGAAGTGAAATCAACTGTATTTTTCTTTGAGTGTGTGGCACTAGAGTCTCTGATGGATCTGAATGATTGGGCCCGCGGGTCCAGAAGATTTGGCGTTCAATCGAAGCCCTATCTAACCTGCCTTGGAACCCTGCCGCATCACGGGAAATGGTGCGCCGCAAGAAGACCAGTCCATCCACATTTTTCCTCACTTGTATTGGTCCTTCTGTTTTGTCAGGCCTTGTTGGTTTGAGGCCATATTCCTTGAGAATTTGAGTGAGGCGGGCTGGGTCAAAATCTATGTCAGTTGACACAATCTCATCATCACCATAAAATGAGAAATATGACATGGATTGCACCACATCAGGTGATAAACCAGTGGCCTCAGACAGTGCACAGAGAGTAATTATCCAGTGATTTATGCTGTTCACCTGGGAAGTACATGGGAATCCAGATGGCAGCCCCTCTTTGACCCTGATGACATAATCACCTACATCCATCTCAGATGGTGCTAGCAAATCTTGGGCCACAACCTCGGCCAATTCTGGTGAGGCCGTAAGGCGCGACATAATGGAGAAGGATTCTGTCATAATTTGTCTATTTTGTGTTGAGTCCCATGCTGTATAATCTGCATCAAAATGATTCTTATATTTAGCATGCTCAGCATAGATGAGGGGGCCATCTTCTATTGTGTTCATGCCAACTTTTATTGGCAATTTGATGACATGTGATTTTATAGCGTCACAAAATGGGCCAAAAGCCCGGGCGGCCCTGACCACTGTTCCGAGATCGGCGCCCCATAGTAGACGCTTCTTGACTTTTTGATAAATCTTTTCTGGCTTGACTAGTTCATCTTTTAAGGCTGCAGTGTAAATGGGTTTCATATGTTTAGCATTCTCATACATATTGTTGGCGTGTGCAGCTTGCTCACCGAGCTCTCCAACGAAGGTGGTGCCATTCCAATCATCATTCTTCCTTTTATGGTGAGGGTACCCCGAACTAGTAGTTTTGTCAAGAGATTGGCAGGCATCAGCGTAAGACCACGGGCTTGGGGTATCCATTGTCTGTTCTAACATGGATGTTACAGTCTCAACCGCAGCCTCCAGTAGGCCAGGCTCAGGCATGCGGCCGCGGGGGTCCGCAAAGGGTTTCAGTTGGTCACGTAGTACCTGTTGTAGGGATGGGCCATTCTGTACACGGGGGTCCTTGCCCCCCAGGTATGCTGGCTCATATACTCCGGGGGGCAGTGGTTCTGGGGAGGACCTCCAGAATTTTGTTTTAGTTGACAGTGCTGGGCCACTTCCATACCTCACAATCTCGTGGCCGGCATAATGCCCCTTGTCTCCACCTTCTAGTGCGGTTTCGCCCTCTCCAGCCTGTACAGCGCAGACCACGGTGTTGCCTGACTTTGTGGCTGCAGCGTGGACTCCACACACAACCCAGTCATTCCCGCGCTTGTGGACGTATGGTGCCCCGCAGTCTCCTGGTATAGTGCCAAGATCCATCCCCTTTGCATTGGCCCCTGTCAGTAACATCCCTGATTGGCCATGGACAAGCCGACCCTGTATCCTCATGGAGGCAATAGCCCCCATACGGACGGCTAGCGGAAGTAGTTCACCCGAATCCCGTTTAATTAGGACTGAGCAGACTGTCCCTTCAGGGCAACCTTCTTCAAGGACCATACCTGTCAAGTCAGGGCGCATTTTCTTTGAGAACCTGAATTGTGTGAACTCACCTGCTTGGTGGATTGCTATACTAGATAGGGGCTCACCAAAGAATTCTTTCACACCAGTTGGCACTACATGTGTGGTTGTGATGAACACTGTCGGGCTGACCCAAAAGCCCCATCCTGATCCAAACTTTGTGACTCGGCTCCATAGTGTCGGGGGAGCTTCAAAATTGATCTTTTCATTATAATCCACCTCTCTGTCATCATCTGCCCATTCATTCTTTGGCGGGGTCCAGTCAATGGGCTTACGTTTTCTGATGTCTGATCCAGTCACTAGACCAAGTTGTCGCCGTTGCTCTTGTTGGTGTTTCTTACTCTTGGATTTATAGAAGACCCTGTGACGGATTTCCATTTCAGTTTCTCCTATGCCACCATCACCACCTGCCTGTACCTCTGCTAATTCTTCCTCATATCGTTGGCGGTCCTCCAAGTATTCTTGTATACTATAATTGCCATTCTTTTCTTCTCTGATCTTTTTGTACTCTTCATATTCTTCATCACTCAGACCACGGCGAGAGAATGCATTATAGTTATTTTTGCGACCACGTCCCTTTTTGGTCTTGCCTTTGTTCTTTCCTTCTGGGACGGCATCACTTGGTACCATTTGAATTTGGTCCTCACTCTCCTCCTCTTCAGTTTCACATAGGCCAAACCTTTCTACCATGTCATCATGACCTATGGGCCCCTTTCCAGCTTCCTTAGCCTTATGGACCCTGCAATTATGTTCTTTCCCAGGTCCTTCTAATGCCATGGCTGCTGTACGGGTACCAAACATACGCTTGACCGCTCGATTAATAACGAGCGCAGATCCCGCCATTTGTAGTATGGTAGTTATGGCGGACTGGAAACATGAAGCGTATGCCACAGCCCTAGCTGCTTTGAGTCGAGTGATGGCAAGTGAGGCCGTGTTAATTGTCTGCTGCAGAGGGGTCAAAGCTTGCTTGTCTTCTTTGATTTGTACACTGGCACCATCTGATTCTATAATGTACACCCTTGACTGCCATTGTATACTGCATTTTGATATTTTATAGCCTGATAGAGCATTCTTTAATCCTTCAATAGTGGTGACACTGCGTAGCTTTTTGCCTAGGGAGGCCATGGATATGAGACCCAACCCGTTGGCTCGGGCCATCCTCGTGAACGCAGCTACTCTGTCAGTATCAAAGTCATACGTAGGCCCCTGGAGTTGGAACTCATCCTGTCTCTCCATCGTCAAGGCTACAGCCTGGATTAACAGCCTGTTTATGGTGGTGGGCTTCATCACACCCTTACCAAACGGGGTATTCCCTTGGTTATCAAAGCCCCCTTGGGGAGCCAACTCCATTTTTAGATGTGAGAAATCGGGCTTGAAGCAGTCTTTCAGTGCAGTTGTGTCCCCAGGACTGACTTTCCTCGTGTGTTCAACTTCAGGTGCCGTGCAATACACAAGGAAGTCCACCCTTCGGCAAACAGGCCCGAGGTTGACAAAGTCCACTGGGGCTGGGCCAGGAGCATTGGTGGTGATGACTATAGCATCAGACACAAATTGCATTCCCTTGTTTTCTATTCGGTCACAATTGAGTGTTAGGGGGGCTGAGTCGGCTATGGCTTGCAGTTTATTACAGTCTTCCTGTATCTTTGTCATTCCATAGTCGTCCCACAGCATCACTTCCTCTCCGTGATATCCATCCCAATGATCCACTGCCTCCCGTGGGACCAGCCCAACCTTACCACCAGGCCGTATCTCATTGGCTAGGCGTTTAGCCAGATGTTCTGCTGCCTTGGTTTTACCTATACCAGGGGGCCCACACATCATAATGACCACAGGACGCATCCTGCTGGTCATTTCAGCTTGAGCCTTGGCCAATGCAGCCCTAGCCATTGAGATCCGGGATATGAGAGCATTGGTAGAGGATACTACGTGTGGGTCGGCATTCCTGACAGATAATTTCCTTGCCTTTTCTTCTTCATTATCTAAGATGGCCATATAAGCCCGTGCAGACTGTTTGTCCCTCACGAGCTGAGTCACTGATGTAGATGATAGTACTTCCATATCTATAACTGCTGACTCAATATCTTTTAGGGTTTTCTCTGTTTGATCACCACCGAAGAAGTACTTCTTTAGTAATGAGAATATTTCTAGGCCATATTGACCGAGCTGGGTTGCCGCACGAAGTCCATCAACAGCATTCTTCATCATCTTACTTACCTTGTCTCTGGTGAATCCTATGGCTAAGCCGATCCCCCCCAATACTATTGGCACGAGATCCCTGGCAAGGTCCTCGGGGCCCTGTAGATGGAAATCTGGCAGGAGTGAAGCTATAAAGTTGGAAACATCAGGTGGGTTCCAAAAGATTCCAAAGAGTTCTAAAAGGAGGACCACCATCTCCACGACCCCCATGAACGTCCAATCACAGTTTGAAAGTAAGTTAAGCACGTTCAAGGGTTTGAGCTTACCCAGAAGATCTTTAAATGGCCGCGACACCAACCCATTTATAGCGGCTAGCACTGCATCCCTAACCATCTCTAACTTGCTGTCTTGTTGGAATTCTGGAGTGTCTCGGGACCAATCTTGGGTCGGGTGGTAAAACCGGCCAGAGGAGATGAGCTTCCTTTGCAACCAAGTATCTTCCAAGCACATGACCTGGCAACAAAATTCGAAGCAGTTGTTCGTGACTGCGGCATACGGCCATGGTTCATTTTCTAATTCTTTGAGTTGGTCGTATGTGAGCCTCTGTTTTGGTTGTGGGACATAACAGACTCGCCACCAAGCTGATATGGGCTGTATGGTGATCCTCGTTATTGAGAAGGCTGCTTGAGGGGAGTGTACACCCACCGTCTTGCCTTGACCTATGTATATAGCATAATGATAGATGTGCCCTTCATAGAATTCGATCATGTCACCAATTGTGGGCTCAGTTGCAGGTGTCGTGCTCCTTTGGTCAACTGGTGGTAGCGGGCACATATTCCACTCAGGCCCAGACACCGTCGTGAGCCCGGATATGCCAAGGTCTACACCTTCCCTAGCCGACCACTTTACCTGGTGGCCTTCATCATTCTCATGTGTGTACCGTTCATGACTAGTGGGTAGTGTACTTGGACCTAAGCCACCGGCATCAAACCACTCAGCGTGTTCATCAAGTATCTGTTGTTTTGTTGTGTGGTCAAGCTCATCCCACGTCTTAACATTCTGGTCTTGTGGTCTCTCAGTCCAACGCAAATTTTGTTGAACTTCGGCAACAGTCCGTGGTGGTCTATCCCTCTGTTGTTTAGGGACATCGACGGATGTGGCCTTTGGCGCTGGGACCTGTCCAATCAGCCCCAGAGCCATATCTTGGTTGGTTATCTTTATCGAGTTGGGTGGGGACGTAGCCCCACCTGAACCCTTGAGTCTCGCCAATAGACGAGACTTAATACTACTATTGTTGTTAGCATTTTCACTGCTAGCAGCAGTAGGAACGACGTCTTTTGACGCCATCATCATTCACGGTTCTATCTCCTTCGAAGCCTGCTTTTTTGTACAAACTTGTGATTCGAGGCAAGCTTGAATTCCTCACGACACCTGAAATGGAAGAAAAAAACTTTGAACCACTGTCTGAGGCTTGAGAATGAACCAAGATCCAAACTCAAAAAGGGCAAATTCCAAGGAGAATTACATCAAGTGCCAAGCTGGCCTAACTTCAGTCTCCACCCACTCAGTGTGGGGAAACTCCATCGCATAAAACCCCTCCCCCCAACCTAAAGACGACGTACTCCAAAAGCTCGTCGAGAACTAATCGAGGTGCCTGGACGGCGCCCGGTACTCCGTGGAGTCACATGAAGCGACGGCTGAGGACGGAAAGGCCCTTTTCCTTTGTGTGGGTGACTCACCCGCCCGCTCTCCCGAGCGCCGCGTCCTCCATTTTGAGCTCCCTGCAGCAGGGCCGGGAAGCGGCCATCTTTCCGCTCACGCAACTGGTGCCGACCGGGCCAGCCTTGCCGCCCAGGGCGGGGCGATACACGGCGGCGCGAGGCCAGGCACCAGAGCAGGCCGGCCAGCTTGAGACTACCCCCGTCCGATTCTCGGTGGCCGCGCTCGCAGGCCCCGCCTCGCCGAACATGTGCGCTGGGACGCACGGGCCCCGTCGCCGCCCGCGGCCCCAAAAACCGAAATACCAGTGTGCAGATCTTGGCCCGCATTTACAAGACTATCTTGCCAGAAAAAAAGCGTCGCAGCAGGTCATCAAAAATTTTAAATGGCTAGAGACTTATCGAAAGCAGCGAGACAGGCGCGAAGGTGCCACCAGATTCGCACGCGGCGGCCCCAGCGCCCAGGCCAGGCCTCAACTCAAGCACGAGGCGAAGGGGCTCCTTAAGCGCAAGGCCTCGAACTCTCCCACCCACTTCCAACCCGAAGCTCGGGATCAAGAATCACGTACTGCAGCCAGGGGCGTGGAAGTAATTCAAGGCACGCAAGGGCCATAACCCGTAAAGAGGCCAGGCCCGCGGGAACCACACACGGCACTTACCTGTGTTCTGGCGGCAAACCCGTTGCGAAAAAGAACGTTCACGGCGACTACTGCACTTATATACGGTTCTCCCCCACCCTCGGGAAAAAGGCGGAGCCAGTACACGACATCACTTTCCCAGTTTACCCCGCGCCACCTTCTCTAGGCACCGGTTCAATTGCCGACCCCTCCCCCCAACTTCTCGGGGACTGTGGGCGATGTGCGCTCTGCCCACTGACGGGCACCGGAGCCTCACGAATTAATTCTTGAAGACGAAAGGGCCTCGTGATACGCCTATTTTTATAGGTTAATGTCATGATAATAATGGTTTCTTAGACGTCAGGTGGCACTTTTCGGGGAAATGTGCGCGGAACCCCTATTTGTTTATTTTTCTAAATACATTCAAATATGTATCCGCTCATGAGACAATAACCCTGATAAATGCTTCAATAATATTGAAAAAGGAAGAGTATGAGTATTCAACATTTCCGTGTCGCCCTTATTCCCTTTTTTGCGGCATTTTGCCTTCCTGTTTTTGCTCACCCAGAAACGCTGGTGAAAGTAAAAGATGCTGAAGATCAGTTGGGTGCACGAGTGGGTTACATCGAACTGGATCTCAACAGCGGTAAGATCCTTGAGAGTTTTCGCCCCGAAGAACGTTTTCCAATGATGAGCACTTTTAAAGTTCTGCTATGTGGCGCGGTATTATCCCGTGTTGACGCCGGGCAAGAGCAACTCGGTCGCCGCATACACTATTCTCAGAATGACTTGGTTGAGTACTCACCAGTCACAGAAAAGCATCTTACGGATGGCATGACAGTAAGAGAATTATGCAGTGCTGCCATAACCATGAGTGATAACACTGCGGCCAACTTACTTCTGACAACGATCGGAGGACCGAAGGAGCTAACCGCTTTTTTGCACAACATGGGGGATCATGTAACTCGCCTTGATCGTTGGGAACCGGAGCTGAATGAAGCCATACCAAACGACGAGCGTGACACCACGATGCCTGCAGCAATGGCAACAACGTTGCGCAAACTATTAACTGGCGAACTACTTACTCTAGCTTCCCGGCAACAATTAATAGACTGGATGGAGGCGGATAAAGTTGCAGGACCACTTCTGCGCTCGGCCCTTCCGGCTGGCTGGTTTATTGCTGATAAATCTGGAGCCGGTGAGCGTGGGTCTCGCGGTATCATTGCAGCACTGGGGCCAGATGGTAAGCCCTCCCGTATCGTAGTTATCTACACGACGGGGAGTCAGGCAACTATGGATGAACGAAATAGACAGATCGCTGAGATAGGTGCCTCACTGATTAAGCATTGGTAACTGTCAGACCAAGTTTACTCATATATACTTTAGATTGATTTAAAACTTCATTTTTAATTTAAAAGGATCTAGGTGAAGATCCTTTTTGATAATCTCATGACCAAAATCCCTTAACGTGAGTTTTCGTTCCACTGAGCGTCAGACCCCGTAGAAAAGATCAAAGGATCTTCTTGAGATCCTTTTTTTCTGCGCGTAATCTGCTGCTTGCAAACAAAAAAACCACCGCTACCAGCGGTGGTTTGTTTGCCGGATCAAGAGCTACCAACTCTTTTTCCGAAGGTAACTGGCTTCAGCAGAGCGCAGATACCAAATACTGTCCTTCTAGTGTAGCCGTAGTTAGGCCACCACTTCAAGAACTCTGTAGCACCGCCTACATACCTCGCTCTGCTAATCCTGTTACCAGTGGCTGCTGCCAGTGGCGATAAGTCGTGTCTTACCGGGTTGGACTCAAGACGATAGTTACCGGATAAGGCGCAGCGGTCGGGCTGAACGGGGGGTTCGTGCACACAGCCCAGCTTGGAGCGAACGACCTACACCGAACTGAGATACCTACAGCGTGAGCTATGAGAAAGCGCCACGCTTCCCGAAGGGAGAAAGGCGGACAGGTATCCGGTAAGCGGCAGGGTCGGAACAGGAGAGCGCACGAGGGAGCTTCCAGGGGGAAACGCCTGGTATCTTTATAGTCCTGTCGGGTTTCGCCACCTCTGACTTGAGCGTCGATTTTTGTGATGCTCGTCAGGGGGGCGGAGCCTATGGAAAAACGCCAGCAACGCGGCCTTTTTACGGTTCCTGGCCTTTTGCTGGCCTTTTGCTCACATGTTCTTTCCTGCGTTATCCCCTGATTCTGTGGATAACCGTATTACCGCCTTTGAGTGAGCTGATACCGCTCGCCGCAGCCGAACGACCGAGCGCAGCGAGTCAGTGAGCGAGGAAGCGGAAGAGCGCCTGATGCGGTATTTTCTCCTTACGCATCTGTGCGGTATTTCACACCGCATATGGTGCACTCTCAGTACAATCTGCTCTGATGCCGCATAGTTAAGCCAGTATACACTCCGCTATCGCTACGTGACTGGGTCATGGCTGCGCCCCGACACCCGCCAACACCCGCTGACGCGCCCTGACGGGCTTGTCTGCTCCCGGCATCCGCTTACAGACAAGCTGTGACCGTCTCCGGGAGCTGCATGTGTCAGAGGTTTTCACCGTCATCACCGAAACGCGCGAGGCAGCTGTGGAATGTGTGTCAGTTAGGGTGTGGAAAGTCCCCAGGCTCCCCAGCAGGCAGAAGTATGCAAAGCATGCATCTCAATTAGTCAGCAACCAGGTGTGGAAAGTCCCCAGGCTCCCCAGCAGGCAGAAGTATGCAAAGCATGCATCTCAATTAGTCAGCAACCATAGTCCCGCCCCTAACTCCGCCCATCCCGCCCCTAACTCCGCCCAGTTCCGCCCATTCTCCGCCCCATGGCTGACTAATTTTTTTTATTTATGCAGAGGCCGAGGCCGCCTCGGCCTCTGAGCTATTCCAGAAGTAGTGAGGAGGCTTTTTTGGAGGCCTAGGCTTTTGCAAAAAGCTAGCTTGCATGCCTGCAGGTCGGCCGCCACGACCGGTGCCGCCACCATCCCCTGACCCACGCCCCTGACCCCTCACAAGGAGACGACCTTCCATGACCGAGTACAAGCCCACGGTGCGCCTCGCCACCCGCGACGACGTCCCCCGGGCCGTACGCACCCTCGCCGCCGCGTTCGCCGACTACCCCGCCACGCGCCACACCGTCGACCCGGACCGCCACATCGAGCGGGTCACCGAGCTGCAAGAACTCTTCCTCACGCGCGTCGGGCTCGACATCGGCAAGGTGTGGGTCGCGGACGACGGCGCCGCGGTGGCGGTCTGGACCACGCCGGAGAGCGTCGAAGCGGGGGCGGTGTTCGCCGAGATCGGCCCGCGCATGGCCGAGTTGAGCGGTTCCCGGCTGGCCGCGCAGCAACAGATGGAAGGCCTCCTGGCGCCGCACCGGCCCAAGGAGCCCGCGTGGTTCCTGGCCACCGTCGGCGTCTCGCCCGACCACCAGGGCAAGGGTCTGGGCAGCGCCGTCGTGCTCCCCGGAGTGGAGGCGGCCGAGCGCGCCGGGGTGCCCGCCTTCCTGGAGACCTCCGCGCCCCGCAACCTCCCCTTCTACGAGCGGCTCGGCTTCACCGTCACCGCCGACGTCGAGGTGCCCGAAGGACCGCGCACCTGGTGCATGACCCGCAAGCCCGGTGCCTGACGCCCGCCCCACGACCCGCAGCGCCCGACCGAAAGGAGCGCACGACCCCATGGCTCCGACCGAAGCCACCCGGGGCGGCCCCGCCGACCCCGCACCCGCCCCCGAGGCCCACCGACTCTAGCTAGAGGATCATAATCAGCCATACCACATTTGTAGAGGTTTTACTTGCTTTAAAAAACCTCCCACACCTCCCCCTGAACCTGAAACATAAAATGAATGCAATTGTTGTTGTTAACTTGTTTATTGCAGCTTATAATGGTTACAAATAAAGCAATAGCATCACAAATTTCACAAATAAAGCATTTTTTTCACTGCATTCTAGTTGTGGTTTGTCCAAACTCATCAATGTATCTTATCATGTCTGGATCCTCTAGAGTCGACCGCGGCCGCGGCCTCGA";
### the $str variable contains the reverse complement sequence of pKS-NV68 ###
#	print "$str\n";
my $a = 0;
my $threepjunc = 12790 - $a;
my $b = $a + 28;
while ($a<12762) {  ## loop extracts 9 bp sequences from pKS-NV68 reverse complement that is stored in the $str variable ##
	if (($a % 100) == 0) {
		print "$a\n"; 
	}	
	my $nuc = substr($str, $a, $b);  ## extracts the sequence from pKS-NV68 rev comp in $str ##
#	print "$nuc\n";
	my $search = "AACTCTAGT$nuc";
#	print "$search\n";
#	my $rcsearch = reverse $search;
#	$rcsearch =~ tr/ACGTacgt/TGCAtgca/;
#	my $count1 = 0;
	my $i = 0; ## i is for the reads and the fivepjuncs arrays
	my @ftkeys = ();	
	foreach $read (@reads) {  # unwinds the array with each paired end sequence that was placed in the array in the initial while loop ###
#		print "$read\n";
#		print "$fivepjuncs[$i]\n";
#		if (($i % 10000) == 0) {
#			print "$i\n"; 
#		}
		if ($read =~ /$search/) { ## this searches for the junction sequence in $search against the paired end read sequence ###
			# $count1++; ##count incremented up by one if the read contains the junction sequence ###
			# push (@jc, $threepjunc); ## creates an array of the junctions where there are matches to the search sequence ###
			$fivepjunc = $fivepjuncs[$i];
			my $ftkey = $fivepjunc."\t".$threepjunc;
			#if ($threepjunc < $fivepjunc) {
				#print "WAO\t5': $fivepjunc\t3': $threepjunc\t$i\t$read\n";
				#print WAO "WAO\t5': $fivepjunc\t3': $threepjunc\t$i\t$read\n";
			#}
			# print "$ftkey\n";
			if (exists($hits{$ftkey})) {
				$hits{$ftkey} = $hits{$ftkey} + 1; 
			} else {
				$hits{$ftkey} = 1;
				push(@ftkeys, $ftkey);
			}
		} ## end of if loop that determines if there is a match in the read to $search ###
		$i++;
	} ## end of the foreach loop that contains the paired end read sequences for the if loop search ##
	foreach $key (@ftkeys) {	
		print"$key\t $hits{$key}\n";
	}
	$a++;
	$threepjunc--;
}  ## end of the while loop that extracts each segment of pKS-NV68 from $str for comparison to reads in the foreach loop ##


foreach my $ftkey (sort keys %hits) {
	print COUNTSUM "$ftkey\t$hits{$ftkey}\n"
#	print OUTFILE "$ftkey\t$hits{$ftkey}\n"
}

# close OUTFILE;
close COUNTSUM;
#close WAO;

		
exit;
