#!/usr/bin/perl
##### Program to divide the target plasmid into defined sections and then search these against a file of reads###
open (INFILE, "<", $ARGV[0]);
# open OUTFILE, ">/home/tim/python/2-GI-1-s-R2-257-results-1N-lg"; 
# output file for each sequence match with the junction point and the sequence linked with coordinates 
open (OUTFILE, ">", $ARGV[1]); 
# open COUNTFILE, ">2-GI-1-s-R2-257-5p-junc-counts-1N-lg"; 
# output file for junction points in pKS-NV68 and number of times they appear
open (COUNTFILE, ">", $ARGV[2]);
while (my $line = <INFILE>) {   
## read each line of the sequence reads file and do operations on it and then move to next line
	chomp($line);
	push(@reads, $line); 
### creates an array where each element is a line from the sequence reads file
	}	
##### scalar variable containing the target plasmid to be divided into fragments and searched against reads
	my $str = "TCGAGGCCGCGGCCGCGGTCGACTCTAGAGGATCCAGACATGATAAGATACATTGATGAGTTTGGACAAACCACAACTAGAATGCAGTGAAAAAAATGCTTTATTTGTGAAATTTGTGATGCTATTGCTTTATTTGTAACCATTATAAGCTGCAATAAACAAGTTAACAACAACAATTGCATTCATTTTATGTTTCAGGTTCAGGGGGAGGTGTGGGAGGTTTTTTAAAGCAAGTAAAACCTCTACAAATGTGGTATGGCTGATTATGATCCTCTAGCTAGAGTCGGTGGGCCTCGGGGGCGGGTGCGGGGTCGGCGGGGCCGCCCCGGGTGGCTTCGGTCGGAGCCATGGGGTCGTGCGCTCCTTTCGGTCGGGCGCTGCGGGTCGTGGGGCGGGCGTCAGGCACCGGGCTTGCGGGTCATGCACCAGGTGCGCGGTCCTTCGGGCACCTCGACGTCGGCGGTGACGGTGAAGCCGAGCCGCTCGTAGAAGGGGAGGTTGCGGGGCGCGGAGGTCTCCAGGAAGGCGGGCACCCCGGCGCGCTCGGCCGCCTCCACTCCGGGGAGCACGACGGCGCTGCCCAGACCCTTGCCCTGGTGGTCGGGCGAGACGCCGACGGTGGCCAGGAACCACGCGGGCTCCTTGGGCCGGTGCGGCGCCAGGAGGCCTTCCATCTGTTGCTGCGCGGCCAGCCGGGAACCGCTCAACTCGGCCATGCGCGGGCCGATCTCGGCGAACACCGCCCCCGCTTCGACGCTCTCCGGCGTGGTCCAGACCGCCACCGCGGCGCCGTCGTCCGCGACCCACACCTTGCCGATGTCGAGCCCGACGCGCGTGAGGAAGAGTTCTTGCAGCTCGGTGACCCGCTCGATGTGGCGGTCCGGGTCGACGGTGTGGCGCGTGGCGGGGTAGTCGGCGAACGCGGCGGCGAGGGTGCGTACGGCCCGGGGGACGTCGTCGCGGGTGGCGAGGCGCACCGTGGGCTTGTACTCGGTCATGGAAGGTCGTCTCCTTGTGAGGGGTCAGGGGCGTGGGTCAGGGGATGGTGGCGGCACCGGTCGTGGCGGCCGACCTGCAGGCATGCAAGCTAGCTTTTTGCAAAAGCCTAGGCCTCCAAAAAAGCCTCCTCACTACTTCTGGAATAGCTCAGAGGCCGAGGCGGCCTCGGCCTCTGCATAAATAAAAAAAATTAGTCAGCCATGGGGCGGAGAATGGGCGGAACTGGGCGGAGTTAGGGGCGGGATGGGCGGAGTTAGGGGCGGGACTATGGTTGCTGACTAATTGAGATGCATGCTTTGCATACTTCTGCCTGCTGGGGAGCCTGGGGACTTTCCACACCTGGTTGCTGACTAATTGAGATGCATGCTTTGCATACTTCTGCCTGCTGGGGAGCCTGGGGACTTTCCACACCCTAACTGACACACATTCCACAGCTGCCTCGCGCGTTTCGGTGATGACGGTGAAAACCTCTGACACATGCAGCTCCCGGAGACGGTCACAGCTTGTCTGTAAGCGGATGCCGGGAGCAGACAAGCCCGTCAGGGCGCGTCAGCGGGTGTTGGCGGGTGTCGGGGCGCAGCCATGACCCAGTCACGTAGCGATAGCGGAGTGTATACTGGCTTAACTATGCGGCATCAGAGCAGATTGTACTGAGAGTGCACCATATGCGGTGTGAAATACCGCACAGATGCGTAAGGAGAAAATACCGCATCAGGCGCTCTTCCGCTTCCTCGCTCACTGACTCGCTGCGCTCGGTCGTTCGGCTGCGGCGAGCGGTATCAGCTCACTCAAAGGCGGTAATACGGTTATCCACAGAATCAGGGGATAACGCAGGAAAGAACATGTGAGCAAAAGGCCAGCAAAAGGCCAGGAACCGTAAAAAGGCCGCGTTGCTGGCGTTTTTCCATAGGCTCCGCCCCCCTGACGAGCATCACAAAAATCGACGCTCAAGTCAGAGGTGGCGAAACCCGACAGGACTATAAAGATACCAGGCGTTTCCCCCTGGAAGCTCCCTCGTGCGCTCTCCTGTTCCGACCCTGCCGCTTACCGGATACCTGTCCGCCTTTCTCCCTTCGGGAAGCGTGGCGCTTTCTCATAGCTCACGCTGTAGGTATCTCAGTTCGGTGTAGGTCGTTCGCTCCAAGCTGGGCTGTGTGCACGAACCCCCCGTTCAGCCCGACCGCTGCGCCTTATCCGGTAACTATCGTCTTGAGTCCAACCCGGTAAGACACGACTTATCGCCACTGGCAGCAGCCACTGGTAACAGGATTAGCAGAGCGAGGTATGTAGGCGGTGCTACAGAGTTCTTGAAGTGGTGGCCTAACTACGGCTACACTAGAAGGACAGTATTTGGTATCTGCGCTCTGCTGAAGCCAGTTACCTTCGGAAAAAGAGTTGGTAGCTCTTGATCCGGCAAACAAACCACCGCTGGTAGCGGTGGTTTTTTTGTTTGCAAGCAGCAGATTACGCGCAGAAAAAAAGGATCTCAAGAAGATCCTTTGATCTTTTCTACGGGGTCTGACGCTCAGTGGAACGAAAACTCACGTTAAGGGATTTTGGTCATGAGATTATCAAAAAGGATCTTCACCTAGATCCTTTTAAATTAAAAATGAAGTTTTAAATCAATCTAAAGTATATATGAGTAAACTTGGTCTGACAGTTACCAATGCTTAATCAGTGAGGCACCTATCTCAGCGATCTGTCTATTTCGTTCATCCATAGTTGCCTGACTCCCCGTCGTGTAGATAACTACGATACGGGAGGGCTTACCATCTGGCCCCAGTGCTGCAATGATACCGCGAGACCCACGCTCACCGGCTCCAGATTTATCAGCAATAAACCAGCCAGCCGGAAGGGCCGAGCGCAGAAGTGGTCCTGCAACTTTATCCGCCTCCATCCAGTCTATTAATTGTTGCCGGGAAGCTAGAGTAAGTAGTTCGCCAGTTAATAGTTTGCGCAACGTTGTTGCCATTGCTGCAGGCATCGTGGTGTCACGCTCGTCGTTTGGTATGGCTTCATTCAGCTCCGGTTCCCAACGATCAAGGCGAGTTACATGATCCCCCATGTTGTGCAAAAAAGCGGTTAGCTCCTTCGGTCCTCCGATCGTTGTCAGAAGTAAGTTGGCCGCAGTGTTATCACTCATGGTTATGGCAGCACTGCATAATTCTCTTACTGTCATGCCATCCGTAAGATGCTTTTCTGTGACTGGTGAGTACTCAACCAAGTCATTCTGAGAATAGTGTATGCGGCGACCGAGTTGCTCTTGCCCGGCGTCAACACGGGATAATACCGCGCCACATAGCAGAACTTTAAAAGTGCTCATCATTGGAAAACGTTCTTCGGGGCGAAAACTCTCAAGGATCTTACCGCTGTTGAGATCCAGTTCGATGTAACCCACTCGTGCACCCAACTGATCTTCAGCATCTTTTACTTTCACCAGCGTTTCTGGGTGAGCAAAAACAGGAAGGCAAAATGCCGCAAAAAAGGGAATAAGGGCGACACGGAAATGTTGAATACTCATACTCTTCCTTTTTCAATATTATTGAAGCATTTATCAGGGTTATTGTCTCATGAGCGGATACATATTTGAATGTATTTAGAAAAATAAACAAATAGGGGTTCCGCGCACATTTCCCCGAAAAGTGCCACCTGACGTCTAAGAAACCATTATTATCATGACATTAACCTATAAAAATAGGCGTATCACGAGGCCCTTTCGTCTTCAAGAATTAATTCGTGAGGCTCCGGTGCCCGTCAGTGGGCAGAGCGCACATCGCCCACAGTCCCCGAGAAGTTGGGGGGAGGGGTCGGCAATTGAACCGGTGCCTAGAGAAGGTGGCGCGGGGTAAACTGGGAAAGTGATGTCGTGTACTGGCTCCGCCTTTTTCCCGAGGGTGGGGGAGAACCGTATATAAGTGCAGTAGTCGCCGTGAACGTTCTTTTTCGCAACGGGTTTGCCGCCAGAACACAGGTAAGTGCCGTGTGTGGTTCCCGCGGGCCTGGCCTCTTTACGGGTTATGGCCCTTGCGTGCCTTGAATTACTTCCACGCCCCTGGCTGCAGTACGTGATTCTTGATCCCGAGCTTCGGGTTGGAAGTGGGTGGGAGAGTTCGAGGCCTTGCGCTTAAGGAGCCCCTTCGCCTCGTGCTTGAGTTGAGGCCTGGCCTGGGCGCTGGGGCCGCCGCGTGCGAATCTGGTGGCACCTTCGCGCCTGTCTCGCTGCTTTCGATAAGTCTCTAGCCATTTAAAATTTTTGATGACCTGCTGCGACGCTTTTTTTCTGGCAAGATAGTCTTGTAAATGCGGGCCAAGATCTGCACACTGGTATTTCGGTTTTTGGGGCCGCGGGCGGCGACGGGGCCCGTGCGTCCCAGCGCACATGTTCGGCGAGGCGGGGCCTGCGAGCGCGGCCACCGAGAATCGGACGGGGGTAGTCTCAAGCTGGCCGGCCTGCTCTGGTGCCTGGCCTCGCGCCGCCGTGTATCGCCCCGCCCTGGGCGGCAAGGCTGGCCCGGTCGGCACCAGTTGCGTGAGCGGAAAGATGGCCGCTTCCCGGCCCTGCTGCAGGGAGCTCAAAATGGAGGACGCGGCGCTCGGGAGAGCGGGCGGGTGAGTCACCCACACAAAGGAAAAGGGCCTTTCCGTCCTCAGCCGTCGCTTCATGTGACTCCACGGAGTACCGGGCGCCGTCCAGGCACCTCGATTAGTTCTCGACGAGCTTTTGGAGTACGTCGTCTTTAGGTTGGGGGGAGGGGTTTTATGCGATGGAGTTTCCCCACACTGAGTGGGTGGAGACTGAAGTTAGGCCAGCTTGGCACTTGATGTAATTCTCCTTGGAATTTGCCCTTTTTGAGTTTGGATCTTGGTTCATTCTCAAGCCTCAGACAGTGGTTCAAAGTTTTTTTCTTCCATTTCAGGTGTCGTGAGGAATTCAAGCTTGCCTCGAATCACAAGTTTGTACAAAAAAGCAGGCTTCGAAGGAGATAGAACCGTGAATGATGATGGCGTCAAAAGACGTCGTTCCTACTGCTGCTAGCAGTGAAAATGCTAACAACAATAGTAGTATTAAGTCTCGTCTATTGGCGAGACTCAAGGGTTCAGGTGGGGCTACGTCCCCACCCAACTCGATAAAGATAACCAACCAAGATATGGCTCTGGGGCTGATTGGACAGGTCCCAGCGCCAAAGGCCACATCCGTCGATGTCCCTAAACAACAGAGGGATAGACCACCACGGACTGTTGCCGAAGTTCAACAAAATTTGCGTTGGACTGAGAGACCACAAGACCAGAATGTTAAGACGTGGGATGAGCTTGACCACACAACAAAACAACAGATACTTGATGAACACGCTGAGTGGTTTGATGCCGGTGGCTTAGGTCCAAGTACACTACCCACTAGTCATGAACGGTACACACATGAGAATGATGAAGGCCACCAGGTAAAGTGGTCGGCTAGGGAAGGTGTAGACCTTGGCATATCCGGGCTCACGACGGTGTCTGGGCCTGAGTGGAATATGTGCCCGCTACCACCAGTTGACCAAAGGAGCACGACACCTGCAACTGAGCCCACAATTGGTGACATGATCGAATTCTATGAAGGGCACATCTATCATTATGCTATATACATAGGTCAAGGCAAGACGGTGGGTGTACACTCCCCTCAAGCAGCCTTCTCAATAACGAGGATCACCATACAGCCCATATCAGCTTGGTGGCGAGTCTGTTATGTCCCACAACCAAAACAGAGGCTCACATACGACCAACTCAAAGAATTAGAAAATGAACCATGGCCGTATGCCGCAGTCACGAACAACTGCTTCGAATTTTGTTGCCAGGTCATGTGCTTGGAAGATACTTGGTTGCAAAGGAAGCTCATCTCCTCTGGCCGGTTTTACCACCCGACCCAAGATTGGTCCCGAGACACTCCAGAATTCCAACAAGACAGCAAGTTAGAGATGGTTAGGGATGCAGTGCTAGCCGCTATAAATGGGTTGGTGTCGCGGCCATTTAAAGATCTTCTGGGTAAGCTCAAACCCTTGAACGTGCTTAACTTACTTTCAAACTGTGATTGGACGTTCATGGGGGTCGTGGAGATGGTGGTCCTCCTTTTAGAACTCTTTGGAATCTTTTGGAACCCACCTGATGTTTCCAACTTTATAGCTTCACTCCTGCCAGATTTCCATCTACAGGGCCCCGAGGACCTTGCCAGGGATCTCGTGCCAATAGTATTGGGGGGGATCGGCTTAGCCATAGGATTCACCAGAGACAAGGTAAGTAAGATGATGAAGAATGCTGTTGATGGACTTCGTGCGGCAACCCAGCTCGGTCAATATGGCCTAGAAATATTCTCATTACTAAAGAAGTACTTCTTCGGTGGTGATCAAACAGAGAAAACCCTAAAAGATATTGAGTCAGCAGTTATAGATATGGAAGTACTATCATCTACATCAGTGACTCAGCTCGTGAGGGACAAACAGTCTGCACGGGCTTATATGGCCATCTTAGATAATGAAGAAGAAAAGGCAAGGAAATTATCTGTCAGGAATGCCGACCCACACGTAGTATCCTCTACCAATGCTCTCATATCCCGGATCTCAATGGCTAGGGCTGCATTGGCCAAGGCTCAAGCTGAAATGACCAGCAGGATGCGTCCTGTGGTCATTATGATGTGTGGGCCCCCTGGTATAGGTAAAACCAAGGCAGCAGAACATCTGGCTAAACGCCTAGCCAATGAGATACGGCCTGGTGGTAAGGTTGGGCTGGTCCCACGGGAGGCAGTGGATCATTGGGATGGATATCACGGAGAGGAAGTGATGCTGTGGGACGACTATGGAATGACAAAGATACAGGAAGACTGTAATAAACTGCAAGCCATAGCCGACTCAGCCCCCCTAACACTCAATTGTGACCGAATAGAAAACAAGGGAATGCAATTTGTGTCTGATGCTATAGTCATCACCACCAATGCTCCTGGCCCAGCCCCAGTGGACTTTGTCAACCTCGGGCCTGTTTGCCGAAGGGTGGACTTCCTTGTGTATTGCACGGCACCTGAAGTTGAACACACGAGGAAAGTCAGTCCTGGGGACACAACTGCACTGAAAGACTGCTTCAAGCCCGATTTCTCACATCTAAAAATGGAGTTGGCTCCCCAAGGGGGCTTTGATAACCAAGGGAATACCCCGTTTGGTAAGGGTGTGATGAAGCCCACCACCATAAACAGGCTGTTAATCCAGGCTGTAGCCTTGACGATGGAGAGACAGGATGAGTTCCAACTCCAGGGGCCTACGTATGACTTTGATACTGACAGAGTAGCTGCGTTCACGAGGATGGCCCGAGCCAACGGGTTGGGTCTCATATCCATGGCCTCCCTAGGCAAAAAGCTACGCAGTGTCACCACTATTGAAGGATTAAAGAATGCTCTATCAGGCTATAAAATATCAAAATGCAGTATACAATGGCAGTCAAGGGTGTACATTATAGAATCAGATGGTGCCAGTGTACAAATCAAAGAAGACAAGCAAGCTTTGACCCCTCTGCAGCAGACAATTAACACGGCCTCACTTGCCATCACTCGACTCAAAGCAGCTAGGGCTGTGGCATACGCTTCATGTTTCCAGTCCGCCATAACTACCATACTACAAATGGCGGGATCTGCGCTCGTTATTAATCGAGCGGTCAAGCGTATGTTTGGTACCCGTACAGCAGCCATGGCATTAGAAGGACCTGGGAAAGAACATAATTGCAGGGTCCATAAGGCTAAGGAAGCTGGAAAGGGGCCCATAGGTCATGATGACATGGTAGAAAGGTTTGGCCTATGTGAAACTGAAGAGGAGGAGAGTGAGGACCAAATTCAAATGGTACCAAGTGATGCCGTCCCAGAAGGAAAGAACAAAGGCAAGACCAAAAAGGGACGTGGTCGCAAAAATAACTATAATGCATTCTCTCGCCGTGGTCTGAGTGATGAAGAATATGAAGAGTACAAAAAGATCAGAGAAGAAAAGAATGGCAATTATAGTATACAAGAATACTTGGAGGACCGCCAACGATATGAGGAAGAATTAGCAGAGGTACAGGCAGGTGGTGATGGTGGCATAGGAGAAACTGAAATGGAAATCCGTCACAGGGTCTTCTATAAATCCAAGAGTAAGAAACACCAACAAGAGCAACGGCGACAACTTGGTCTAGTGACTGGATCAGACATCAGAAAACGTAAGCCCATTGACTGGACCCCGCCAAAGAATGAATGGGCAGATGATGACAGAGAGGTGGATTATAATGAAAAGATCAATTTTGAAGCTCCCCCGACACTATGGAGCCGAGTCACAAAGTTTGGATCAGGATGGGGCTTTTGGGTCAGCCCGACAGTGTTCATCACAACCACACATGTAGTGCCAACTGGTGTGAAAGAATTCTTTGGTGAGCCCCTATCTAGTATAGCAATCCACCAAGCAGGTGAGTTCACACAATTCAGGTTCTCAAAGAAAATGCGCCCTGACTTGACAGGTATGGTCCTTGAAGAAGGTTGCCCTGAAGGGACAGTCTGCTCAGTCCTAATTAAACGGGATTCGGGTGAACTACTTCCGCTAGCCGTCCGTATGGGGGCTATTGCCTCCATGAGGATACAGGGTCGGCTTGTCCATGGCCAATCAGGGATGTTACTGACAGGGGCCAATGCAAAGGGGATGGATCTTGGCACTATACCAGGAGACTGCGGGGCACCATACGTCCACAAGCGCGGGAATGACTGGGTTGTGTGTGGAGTCCACGCTGCAGCCACAAAGTCAGGCAACACCGTGGTCTGCGCTGTACAGGCTGGAGAGGGCGAAACCGCACTAGAAGGTGGAGACAAGGGGCATTATGCCGGCCACGAGATTGTGAGGTATGGAAGTGGCCCAGCACTGTCAACTAAAACAAAATTCTGGAGGTCCTCCCCAGAACCACTGCCCCCCGGAGTATATGAGCCAGCATACCTGGGGGGCAAGGACCCCCGTGTACAGAATGGCCCATCCCTACAACAGGTACTACGTGACCAACTGAAACCCTTTGCGGACCCCCGCGGCCGCATGCCTGAGCCTGGCCTACTGGAGGCTGCGGTTGAGACTGTAACATCCATGTTAGAACAGACAATGGATACCCCAAGCCCGTGGTCTTACGCTGATGCCTGCCAATCTCTTGACAAAACTACTAGTTCGGGGTACCCTCACCATAAAAGGAAGAATGATGATTGGAATGGCACCACCTTCGTTGGAGAGCTCGGTGAGCAAGCTGCACACGCCAACAATATGTATGAGAATGCTAAACATATGAAACCCATTTACACTGCAGCCTTAAAAGATGAACTAGTCAAGCCAGAAAAGATTTATCAAAAAGTCAAGAAGCGTCTACTATGGGGCGCCGATCTCGGAACAGTGGTCAGGGCCGCCCGGGCTTTTGGCCCATTTTGTGACGCTATAAAATCACATGTCATCAAATTGCCAATAAAAGTTGGCATGAACACAATAGAAGATGGCCCCCTCATCTATGCTGAGCATGCTAAATATAAGAATCATTTTGATGCAGATTATACAGCATGGGACTCAACACAAAATAGACAAATTATGACAGAATCCTTCTCCATTATGTCGCGCCTTACGGCCTCACCAGAATTGGCCGAGGTTGTGGCCCAAGATTTGCTAGCACCATCTGAGATGGATGTAGGTGATTATGTCATCAGGGTCAAAGAGGGGCTGCCATCTGGATTCCCATGTACTTCCCAGGTGAACAGCATAAATCACTGGATAATTACTCTCTGTGCACTGTCTGAGGCCACTGGTTTATCACCTGATGTGGTGCAATCCATGTCATATTTCTCATTTTATGGTGATGATGAGATTGTGTCAACTGACATAGATTTTGACCCAGCCCGCCTCACTCAAATTCTCAAGGAATATGGCCTCAAACCAACAAGGCCTGACAAAACAGAAGGACCAATACAAGTGAGGAAAAATGTGGATGGACTGGTCTTCTTGCGGCGCACCATTTCCCGTGATGCGGCAGGGTTCCAAGGCAGGTTAGATAGGGCTTCGATTGAACGCCAAATCTTCTGGACCCGCGGGCCCAATCATTCAGATCCATCAGAGACTCTAGTGCCACACACTCAAAGAAAAATACAGTTGATTTCACTTCTAGGGGAAGCTTCACTCCATGGTGAGAAATTTTACAGAAAGATTTCCAGCAAGGTCATACATGAAATCAAGACTGGTGGATTGGAAATGTATGTCCCAGGATGGCAGGCCATGTTCCGCTGGATGCGCTTCCATGACCTCGGATTGTGGACAGGAGATCGCGATCTTCTGCCCGAATTCGTAAATGATGATGGCGTCTAAGGACGCTACATCAAGCGTGGATGGCGCTAGTGGCGCTGGTCAGTTGGTACCGGAGGTTAATGCTTCTGACCCTCTTGCAATGGATCCTGTAGCAGGTTCTTCGACAGCAGTCGCGACTGCTGGACAAGTTAATCCTATTGATCCCTGGATAATTAATAATTTTGTGCAAGCCCCCCAAGGTGAATTTACTATTTCCCCAAATAATACCCCCGGTGATGTTTTGTTTGATTTGAGTTTGGGTCCCCATCTTAATCCTTTCTTGCTCCATCTATCACAAATGTATAATGGTTGGGTTGGTAACATGAGAGTCAGGATTATGCTAGCTGGTAATGCCTTTACTGCGGGGAAGATAATAGTTTCCTGCATACCCCCTGGTTTTGGTTCACATAATCTTACTATAGCACAAGCAACTCTCTTTCCACATGTGATTGCTGATGTTAGGACTCTAGACCCCATTGAGGTGCCTTTGGAAGATGTTAGGAATGTTCTCTTTCATAATAATGATAGAAATCAACAAACCATGCGCCTTGTGTGCATGCTGTACACCCCCCTCCGCACTGGTGGTGGTACTGGTGATTCTTTTGTAGTTGCAGGGCGAGTTATGACTTGCCCCAGTCCTGATTTTAATTTCTTGTTTTTAGTCCCTCCTACGGTGGAGCAGAAAACCAGGCCCTTCACACTCCCAAATCTGCCATTGAGTTCTCTGTCTAACTCACGTGCCCCTCTCCCAATCAGTAGTATGGGCATTTCCCCAGACAATGTCCAGAGTGTGCAGTTCCAAAATGGTCGGTGTACTCTGGATGGCCGCCTGGTTGGCACCACCCCAGTTTCATTGTCACATGTTGCCAAGATAAGAGGGACCTCCAATGGCACTGTAATCAACCTTACTGAATTGGATGGCACACCCTTTCACCCTTTTGAGGGCCCTGCCCCCATTGGGTTTCCAGACCTCGGTGGTTGTGATTGGCATATCAATATGACACAGTTTGGCCATTCTAGCCAGACCCAGTATGATGTAGACACCACCCCTGACACTTTTGTCCCCCATCTTGGTTCAATTCAGGCAAATGGCATTGGCAGTGGTAATTATGTTGGTGTTCTTAGCTGGATTTCCCCCCCATCACACCCGTCTGGCTCCCAAGTTGACCTTTGGAAGATCCCCAATTATGGGTCAAGTATTACGGAGGCAACACATCTAGCCCCTTCTGTATACCCCCCTGGTTTCGGAGAGGTATTGGTCTTTTTCATGTCAAAAATGCCAGGTCCTGGTGCTTATAATTTGCCCTGTCTATTACCACAAGAGTACATTTCACATCTTGCTAGTGAACAAGCCCCTACTGTAGGTGAGGCTGCCCTGCTCCACTATGTTGACCCTGATACCGGTCGGAATCTTGGGGAATTCAAAGCATACCCTGATGGTTTCCTCACTTGTGTCCCCAATGGGGCTAGCTCGGGTCCACAACAGCTGCCGATCAATGGGGTCTTTGTCTTTGTTTCATGGGTGTCCAGATTTTATCAATTAAAGCCTGTGGGAACTGCCAGCTCGGCAAGAGGTAGGCTTGGTCTGCGCCGATAATGGCCCAAGCCATAATTGGTGCAATTGCTGCTTCCACAGCAGGTAGTGCTCTGGGAGCGGGCATACAGGTTGGTGGCGAAGCGGCCCTCCAAAGCCAAAGGTATCAACAAAATTTGCAACTGCAAGAAAATTCTTTTAAACATGACAGGGAAATGATTGGGTATCAGGTTGAAGCTTCAAATCAATTATTGGCTAAAAATTTGGCAACTAGATATTCACTCCTCCGTGCTGGGGGTTTGACCAGTGCTGATGCAGCAAGATCTGTGGCAGGAGCTCCAGTCACCCGCATTGTAGATTGGAATGGCGTGAGAGTGTCTGCTCCCGAGTCCTCTGCTACCACATTGAGATCCGGTGGCTTCATGTCAGTTCCCATACCATTTGCCTCTAAGCAAAAACAGGTTCAATCATCTGGTATTAGTAATCCAAATTATTCCCCTTCATCCATTTCTCGAACCACTAGTTGGGTCGAGTCACAAAACTCATCGAGATTTGGAAATCTTTCTCCATACCACGCGGAGGCTCTCAATACAGTGTGGTTGACTCCACCCGGTTCAACAGCCTCTTCTACACTGTCTTCTGTGCCACGTGGTTATTTCAATACAGACAGGTTGCCATTATTCGCAAATAATAGGCGATGATGTTGTAATATGAAATGTGGGCATCATATTCATTTAATTAGGTTTAATTAGGTTTAATTTGATGTTGGGTCGGCATGGCATCTCCACCTCCTCGCGGTCCGACCTGGGCATCCGAAGGAGGACGCACGTCCACTCGGATGGCTAAGGGAGGGCGGGGATCCGGCTGCTAACAAAGCCCGAAAGGACCCAGCTTTCTTGTACAAAGTGGTGAT";
#	print "$str\n";
	my $a = 0;  # declares the variable to determine the start point in the plasmid in $str to use substr to extract sequence  ###
	my $junc = 1; # declare variable to report the junction point in the plasmid in $str that is used for search versus reads ##
	my $b = $a + 28; ## declares variable defining endpoint for extracting sequence from $str for search versus reads ##
	my $count1 = 0;
	while ($a<12762) {  ## while loop to generate the sequence from plasmid to use for search
		my $nuc = substr($str, $a, $b); ## uses substring function to extract a section of plasmid
#		print "$nuc\n";
#		print OUTFILE "$nuc\n";
		my $search = "AGATCTAGT$nuc";  ## creates the search sequence by adding to the junction sequence##
#		print "$search\n";
#		print OUTFILE "$search\n";
		my $count1= 0;
		foreach $read (@reads) {  ## accesses each line from the reads file by unloading the array
#			print "$read\n";
			if ($read =~ /$search/) {  ### if the read line matches search, it is counted as a hit###
        	        $count1++;
			print "$junc\n  ";
			print OUTFILE "$junc  ";
#			print "search $search\n";
         #    	        print "$count1\n";
#			print "$read\n";
			print OUTFILE "$read\n";
         #    	        print OUTFILE "$count1\n";
	                }
			}
#		print "pKS-NV68 junction $junc  $nuc\n";
#		print "$count1\n"; ## since this is outside the foreach loop but inside while loop, it reports the count of hits for a given fragment of the plasmid used for the search###
#		print OUTFILE "$junc\t $count1\n";
		print COUNTFILE "$junc\t$count1\n";
#		print OUTFILE "pKS-NV68 junction $junc  $nuc\n";
#		print "matches equal $count1\n";
#		print OUTFILE "matches equal $count1\n";
		$a++; ## This is outside the foreach loop and moves to the next base of plasmid in $str to extract search sequence ##
		$junc++; ## Since the search is moving to the next nucleotide in $str, the junction is incremented by one  ###
		}  ## ends the while loop that is defining the sequence from $str for search against reads ##
close (OUTFILE);
close (COUNTFILE);
exit;

